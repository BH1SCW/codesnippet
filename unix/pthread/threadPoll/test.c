#include <pthread.h>
#include "log.h"
#include "tpool.h"
#include "common.h"


log_t *log;        /*进程全局日志文件句柄，线程内的日志文件句柄可在线程内自行装载，如果交易分日志可根据交易码自行*/


void dowork(void *arg)
{
    char * ptr=(char *)arg;
   
   sleep(1);
   printf("hello world! %s\n",ptr);
   /*  sleep(1); */
   /* lprintf(log,INFO,"hello world %s\n",ptr);*/
}


int main(int argc, char *argv[])
{
    tpool_t *pool;  /*线程池句柄*/
   
   
   /* daemonize(); */
    log=log_open("test.log", 0);
  
    pool=tpool_init(100,200,1);
    
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    
  
		tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
  
		tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
    tpool_add_work(pool,dowork,"test!");
  
    /*void *tpool_thread(void *tpool);
    */
    
    sleep(10);
    tpool_destroy(pool,1); 
  
    log_close(log);
    pthread_exit(NULL);
}
